# JsonAndTreeView
### __*отображение json ввиде дерева*__
  *JsonAndTreeView - считывает json-файл и отображаеит его содержимое в виде дерева, можно редактировать дерево и сохранить его в json-файл.*

  ---



__*JSON*__ *([JavaScript Object Notation](https://www.json.org/json-ru.html))* - это облегченный формат структурированных данных, более лаконичный, чем синтаксис XML. Он имеет 6 основных типов данных: bool (истинное или ложное строковое представление), double (соответствует числу в JS), строка, массив (список значений), объект (набор пар ключ-значение) и null.

Хотя cJSON и JsonCpp также широко используются в синтаксических анализаторах C/C++ JSON, классы синтаксического анализа, предоставляемые Qt, обычно используются в структуре Qt. Здесь используются QJson и QTreeView для отображения и редактирования документов JSON.

##Что такое QJson

Qt предоставляет несколько классов для представления документов, узлов и итераторов JSON, которые неявно разделяются.

__*QJsonDocument*__：Используется для чтения и записи документов JSON. Он упаковывает полный документ JSON и может читать и записывать этот документ из текстового представления на основе кодировки UTF-8 и собственного двоичного формата Qt. Вы можете использовать ```QJsonDocument :: fromJson ()``` для преобразования документа JSON из его текстового представления в ```QJsonDocument.toJson ()```, чтобы преобразовать его обратно в текст.

__*QJsonParseError*__：Используется для обозначения ошибки во время синтаксического анализа JSON.

__*QJsonObject*__：Представляет список пар ключ-значение, где ключ является уникальной строкой, а значение представлено ```QJsonValue```. QJson также предоставляет итератор и const_iterator для итерации по ```QJsonObject```. Следует отметить, что в общей структуре JSON список пар «ключ-значение» объекта неупорядочен, а массив упорядочен.Реализация QJSON не обеспечивает упорядоченную настройку объекта.

__*QJsonArray*__：Представляет список значений, значение представлено ```QJsonValue```.

__*QJsonValue*__：Значение хранимых данных имеет шесть основных типов, и перечисление типов можно получить с помощью метода type (): ```Bool```, ```Double```, ```String``` ```Array```, ```Object```, ```Null```, а также ```Undefined``` для указания неопределенного значения.

При использовании этих классов сначала надо добавить соответствующие файлы заголовков.

## Разбираем QJson

Обычно используемые операции - это чтение файла и инициализация ```QJsonDocument``` с помощью ```QByteArray``` или получение объекта или массива из Http. Следующие шаги кода: прочитать файл, проанализировать его в ```QJsonDocument```, пройти через ```QJsonObject``` и ```QJsonArray``` и получить значение.

## Создаём JSON.

Интерфейс toJson () QJsonDocument имеет два параметра форматирования. QJsonDocument :: Compact более компактен без отступов разрыва строки и т.д.:
```{"array":["AAA","BBB","CCC","DDD","777"],"name":"Qt","version":{"major":5,"minor":12,"patch":6}}```

QJsonDocument :: Indented - это более простой для просмотра формат с разрывами строк:
```
{
  "array":[
    "AAA",
    "BBB",
    "CCC",
    "DDD",
    "777"
  ],
  "name":"Qt",
  "version":{
    "major":5,
    "minor":12,
    "patch":6
  }
}
```


## Используем QTreeView для отображения и редактирования JSON

QTreeView довольно часто используется для отображения данных JSON. Я написал простую демонстрацию для отображения и редактирования данных JSON (часть добавления и удаления связана с делегатом, поэтому мне лень писать, но общая структура есть).

На самом деле идея очень проста, синтаксический анализ и генерация дерева похожи на генерацию двоичного дерева:

Экспорт отредактированного дерева похож на обход двоичного дерева:

Каждый узел состоит из класса TreeItem, который эквивалентен узлу связанного списка, и каждый узел имеет родительский узел и несколько дочерних узлов. Что необходимо спроектировать, так это то, что для каждого узла вам нужно пометить его тип, будь то массив, объект или значение, чтобы его можно было легко преобразовать с помощью документов JSON.

Область, которую необходимо улучшить: помимо улучшения функции добавления и удаления узлов, вам также необходимо использовать делегат для делегирования ComboBox, чтобы изменить тип узла: массив, объект или значение.

### ссылки:
 1. [Qt читает и записывает JSON и использует QTreeView для отображения и редактирования данных JSON.](https://russianblogs.com/article/18331377393/)
 2. [github.com gongjianbo/ QJsonAndTreeView](https://github.com/gongjianbo/MyTestCode/tree/master/Qt/QJsonAndTreeView)
